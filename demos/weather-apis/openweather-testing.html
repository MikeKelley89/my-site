<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Weather API demo</title>
    <script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ"
      crossorigin="anonymous"
    />
    <script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
  </head>

  <body>
    <form id="localWeather">
      <div>
        <label for="zip">Enter your zip code:</label>
        <input id="zip" type="text" name="text" />
      </div>
      <div>
        <button
          id="findWeather"
          type="button"
          onclick="getWeather()"
          class="btn btn-danger weatherbutton"
        >
          Check weather conditions
        </button>
      </div>
    </form>

    <h2>Conditions for <span id="location"></span></h2>
    <span><b>Temperature: </b></span><span id="main_temp"></span
    ><span id="main_temp_unit"></span><br />
    <span><b>Wind speed: </b></span><span id="wind_speed"></span>
    <span id="wind_speed_unit"></span><br />
    <span><b>Wind direction: </b></span><span id="wind_direction"></span
    ><span id="wind_degree_unit"></span><br />
    <span><b>Conditions: </b></span><span id="weather_conditions"></span>
    <script>
      $("#localWeather").submit(function (event) {
        event.preventDefault();
        getWeather();
      });

      function getWeather() {
        $.ajax({
          url:
            "https://api.openweathermap.org/geo/1.0/zip?zip=" +
            document.getElementById("zip").value +
            "&appid=48ced08bac40a7979644285e22addce1",
          success: function (response) {
            console.log(response);
            $("#location").text(response.name);
            $.ajax({
              url:
                "https://api.openweathermap.org/data/3.0/onecall?lat=" +
                response.lat +
                "&lon=" +
                response.lon +
                "&exclude=minutely,hourly&appid=48ced08bac40a7979644285e22addce1&units=imperial",
              success: function (response) {
                console.log(response);
                $("#wind_speed").text(response.current.wind_speed);
                $("#wind_direction").text(response.current.wind_speed);
                $("#main_temp").text(response.current.temp);
                $("#weather_conditions").text(
                  response.daily[0].summary +
                    ". Currently it looks like there's " +
                    response.current.weather[0].description +
                    "."
                );
                $("#wind_speed_unit").text(" MPH");
                $("#wind_degree_unit").text(" degrees");
                $("#main_temp_unit").text(" F");
              },
            });
          },
        });
      }
    </script>
  </body>
</html>
